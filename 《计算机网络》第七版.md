《计算机网络》第七版



# 一、概述

* 三大网络：电信网络、有线电视网络和计算机网络，现在是**三网融合**。
* 网络把许多计算机连接到一起，而互联网则把许多网络通过路由器连接到一起。与网络相连的计算机常称为主机。
* 现在的互联网已不是某个组织所拥有，而是世界上大大小小的ISP所共同拥有的，这就是互联网也称为“网络的网络”的原因。
* 速率：网络技术中的速率指的是数据的传送速率，也称为数据率或比特率，速率的单位是bit/s。
* 带宽：某信道允许通过的信号频带范围。
* 互联网现在采用存储转发的**分组交换**技术，以及三层ISP结构。
* 互联网按工作方式可划分为边缘部分与核心部分。主机在网络的边缘部分，其作用是进行信息处理。路由器在网络的核心部分，其作用是按存储转发方式进行分组交换。
* 按作用范围的不同，计算机网络分为广域网WAN、城域网MAN、局域网LAN和个人区域网PAN。
* 五层协议的体系结构由应用层、运输层、网络层、数据链路层和物理层组成。运输层最重要的协议是TCP和UDP协议，而网络层最重要的协议是IP协议。



# 二、物理层

## 2.1 有关信道的几个基本概念

1. 单工通信：只能由一个方向的通信而没有反方向的交互，如无线电广播。
2. 半双工通信：通信的双方都可以发送消息，但不能双方同时发送。
3. 全双工通信：通信的双方都可以同时发送和接收消息。
4. 基带信号：来自信源的信号，基带信号往往包含较多的低频成分，甚至由直流成分，而许多信道并不能传输这种低频成分和直流分量，于是需要对基带信号进行**调制**。
5. 正交振幅调制：为了达到更高的信息传输速率，必须采用技术上更为复杂的多元制的振幅相位混合调制方法。
6. 奈式准则：在任何信道中，码元传输的速率是有上限的，传输速率超过此上限，就会出现严重的码间串扰问题，使接收端对码元的判决成为不可能。
7. 香农公式:信道的带宽或信道中的信噪比越大，信息传输的极限速率就越高。
8. 带宽：信号具有的频带宽度，允许信号通过的频率范围。

## 2.2 物理层下面的传输媒介

1. 双绞线：把两根互相绝缘的铜导线并排放在一起，然后用规则的方法绞合起来。模拟传输和数字传输都可以使用双绞线，通信距离一般为几到十几公里。使用双绞线最多的地方就是电话系统。
2. 同轴电缆：由内导体铜芯线、绝缘层和网状编织的外导体屏蔽层组成。目前同轴电缆主要用在有线电视网的居民小区中。
3. 光缆：利用光导纤维传递光脉冲来进行通信，原理是光的全反射。
4. 多模光纤：存在多条不同角度入射的光线在一条光纤中传输。光脉冲在多模光纤中传输会逐渐展宽，造成失真，因此多模光纤只适合短距离传输。
5. 单模光纤：光纤的直径减小到只有一个光的波长，则光纤就像一根波导那样，可以使光线一直向前传播，而不会产生多次反射。单模光纤的光源要使用昂贵的半导体激光器，而不能使用廉价的发光二极管。
6. 微波通信：
   * 微波波段频率很高，其频段范围也很宽，因此其通信信道的容量很大。
   * 微波接力通信相邻之间必须直视，不能由障碍物。
7. 卫星通信：
   * 通信距离远，且通信费用与通信距离无关。
   * 频带很宽，通信容量大，信号受到的干扰小。
   * 具有较大的时延。
   * 保密性相对较差。

## 2.3 信道复用技术

1. 如果在发送端使用一个复用器，就可以让大家合起来使用一个共享信道进行通信。在接收端再使用分用器，把合起来传输的信息分别送到相应的终点。

### 2.3.1 （统计）时分复用

* 所有用户在不同的时间占用同样的频带宽度。
* 当某用户暂时无数据发送时，在时分复用帧中分配给该用户的时隙只能出于空闲状态，其他用户即使一直有数据要发送，也不能使用这些空闲的时隙，造成了信道利用率不高的结果。
* **统计时分复用**是一种改进的时分复用，它能明显地提高信道的利用率。统计时分复用使用STDM帧来传送复用的数据，但每一个STDM帧中的时隙数小于连接在集中器上的用户数。各用户有了数据就随时发往集中器的输入缓存，然后**集中器**按顺序依次扫描输入缓存，把缓存中的输入数据放入STDM帧中。对没有数据的缓存就跳过去。当一个帧的数据放满了，就放出去。**因此，STDM帧不是固定分配时隙，而是按需动态地分配时隙。**这样可以提高信道的利用率。
* **集中器**能够正常工作的前提是假定各用户都是间歇地工作。
* 由于STDM帧中的时隙并不是固定地分配给某个用户，因此在每个时隙中还必须有用户的地址信息，这是统计时分复用必须要有的，且是不可避免的一些开销。

### 2.3.2 波分复用

* 光的频分复用。
* 人们经常在一根光缆中放入尽可能多的光纤，然后对每一根光纤使用密集波分复用技术。

### 2.3.3 码分复用（CDM）

* 一种共享信道的方法，更常用码分多址（CDMA）来描述。
* 每一个用户可以在同样的时间使用同样的频带进行通信。由于各用户使用经过特殊挑选的不同码型，因此各用户之间不会造成干扰。



## 2.4 带宽接入技术

### 2.4.1 ADSL技术（非对称数字用户线）

* 用数字技术对现有的模拟电话用户线进行改造，使它能够承载带宽数字业务。
* 由于用户上网时主要是从互联网下载各种文档，而向互联网发送的信息量一般都不太大，因此，ADSL的下行带宽都远远大于上行带宽。

### 2.4.2 光纤同轴混合网（HFC网）

* 在目前覆盖面很广的有线电视网的基础上开发的一种居民宽带接入网，除可传送电视节目外，还能提供电话、数据和其他带宽交互型业务。
* 为了提高传输的可靠性和电视信号的质量，HFC网把原有线电视网中的同轴电缆主干部分改换为光纤。光纤从头端连接到光纤结点。在光纤结点光信号被转换为电信号，然后通过同轴电缆传送到每个家庭。
* 要使现在的模拟电视能够接收数字电视信号，需要把一个叫做**机顶盒**的设备连接在同轴电缆和电视机之间。

### 2.4.3 FTTx技术

* FTTx表示多种带宽光纤接入方式，表示Fiber to the ....(FTTH:fiber to the home.).



# 三、数据链路层

* 数据链路层的点对点信道：PPP协议；广播信道：CSMA/CD协议。
* 数据链路层的三个基本问题：封装成帧、透明传输和差错检测。
* 适配器、转发器、集线器、网桥、以太网交换机的作用以及使用场合。
* 路由器在转发分组时使用的协议栈只有下面的三层：数据进入路由器后要先从物理层上到网络层，在转发表中找到下一跳的地址后，再下到物理层转发出去。

## 3.1 使用点对点信道的数据链路层

1. 数据链路层把网络层交下来的数据**封装成帧**发送到链路上，以及把接收到的帧中的数据取出并上交给网络层。在互联网中，网络层协议数据单元就是IP数据报。
2. 数据链路层不必考虑物理层如何实现比特传输的细节。
3. 三个基本问题：封装成帧、透明传输和差错检测。

### 3.1.1 封装成帧

* 一段数据的前后分别添加首部和尾部。首部和尾部的一个重要作用就是进行帧界定。
* **最大传输单元（MTU）**：每一种链路层协议都规定了所能传送的帧的**数据部分长度上限。**
* 假定发送端在尚未发送完一个帧时突然出现故障，中断了发送。但随后很快又恢复正常，于是重新从头开始发送刚才未发送完的帧。由于使用了帧界定符，接收端就知道前面收到的数据是个不完整的帧。

### 3.1.2 透明传输

* 传输的数据中任何8比特的组合一定不允许和用作帧界定的控制字符的比特编码一样，否则就会出现帧界定错误。
* **透明**是一个很重要的术语：表示某一个实际存在的食物看起来却好像并不存在一样。
* 透明传输设法使数据中可能出现的控制字符，在接收端不被解释为控制字符。具体做法是：发送端的数据链路层在数据中出现控制字符"SOH"和“EOT”的前面插入一个转义字符“ESC”。而在接收端的数据链路层在把数据送往网络层之前删除这个插入的转义字符。**这种方法成为字节填充或字符填充。**如果转义字符也出现在数据中，那么解决办法仍然是在转义字符的前面插入一个转义字符。**因此，当接收端收到连续的两个转义字符时，就删除其中前面的一个。**

### 3.1.3 差错检测

* **误码率**：传输错误的比特占所传输比特总数的比率。
* 误码率与信噪比有很大的关系。如果设法提高信噪比，就可以使误码率减小。实际的通信链路并非是理想的，他不可能使误码率下降到零。
* **目前在数据链路层广泛使用了循环冗余检验（CRC）的检错技术。**
* CRC运算就是在数据M的后面添加供差错检测用的n位冗余码，然后构成一个帧发送出去。**在所要发送的数据后面增加了n位冗余码，虽然增大了数据传输的开销，但却可以进行差错检测。**
* 为了进行检错而添加的冗余码常称为**帧检验序列FCS**。
* 循环冗余检验CRC和帧检验序列FCS并不是同一个概念。CRC是一种检错方法，而FCS是添加在数据后面的冗余码，在检错方法上可以选用CRC，但也可以不选用 CRC。
* **在数据链路层，发送端帧检验序列FCS的生成和接收端CRC检验都是由硬件完成的，不会延误数据传输。**
* 可靠传输：数据链路层的发送端发送什么，在接收端就收到什么。传输差错可分为两大类：一类就是最基本的比特差错，另一类传输差错则更为复杂（帧丢失、帧重复或帧失序）。
* 对于通信质量良好的有线传输链路，数据链路层协议不使用确认和重传机制，既不要求数据链路层向上提供可靠传输的服务。如果在数据链路层传输数据时出现了差错并且需要进行改正，那么改正差错的任务就由上层协议来完成。对于通信质量较差的无线传输链路，数据链路层协议使用确认和重传机制，数据链路层向上提供可靠传输的服务。**实践证明：这样做可以提高通信效率。**





